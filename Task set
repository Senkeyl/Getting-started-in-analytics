import gspread
import pandas as pd
from df2gspread import df2gspread as d2g
from oauth2client.service_account import ServiceAccountCredentials


path_to_file = '1crwJh88b3UmK_rLJqILvi_zh_eNxcfhCFUj92JqSMoE' #Ссылка на таблицу
api_token = '/mnt/HC_Volume_18315164/home-jupyter/jupyter-s-senkeyl/API/credentials.json' #Наш ключ полученный от гугл

scope = ['https://spreadsheets.google.com/feeds',
         'https://www.googleapis.com/auth/drive'] #Наши сервисы

httpAuth = ServiceAccountCredentials.from_json_keyfile_name(api_token, scope) #Ключ от сервесов гугл и эти сервисы

gs = gspread.authorize(httpAuth) #Авторизация
name = 'new_table' #Имя таблицы в googlesheet
work_sheet = gs.open(name) #Открытие этой таблицы

sheet1 = work_sheet.sheet1 #Метод sheet1 возвращает первый лист (sheet) в таблице

data = sheet1.get_all_values() #Метод возвращает все данные в таблице в виде списка списков

headers = data.pop(0) #Создание названия колонок на основе первой строки

df = pd.DataFrame(data, columns=headers) #Создание датафрейма на основе листа 

sheet1 = sheet1.append_row(['500', 'Group_1']) #Добовление данных в лист

table_name = 'New_table' #Имя новой таблицы
sheet = gs.create(table_name) #Создание таблицы
my_mail = 'xtrngr11@gmail.com'
sheet.share(my_mail, perm_type='user', role='writer') #Видимость таблицы

df1 = pd.read_csv('data.csv')

sheet_name = 'newlist'

d2g.upload(df1, table_name, sheet_name, credentials=httpAuth, row_names=True)

#1.Наш датафрейм на основе которого создаем лист 2. Имя таблицы 3. Имя лисиа 4. Ключ доступа

spreadsheet_url = "https://docs.google.com/spreadsheets/d/%s" % sheet.id 
#Получение ссылки на таблицу, где sheet результат sheet = gs.create(table_name) создание таблицы

